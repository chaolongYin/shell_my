#!/bin/bash
function print_usage(){
#conflict with some command,eg find or sed,some print usage means cat other_shell_usage
cat ~/shell_my/unexeshell/other_shell_usage
echo "Usage:"
echo "other_shell argc"
echo "argc: kernel_arm32_cscope kernel_arm64_cscope mtk_kk_old_kernel_tags_update normal_proj_tags_update update_ctags"
}
if [ $# -eq 0 ]
then
	echo "just show usage"
	print_usage

elif [ $1 == "normal_proj_tags_update" ]
then
	echo "update normal proj cscope ctags current dir"
find . -name '*.c' -o -name '*.cpp' -o -name '*.h' -o -name '*.cc' -o -name '*.java'  -o -name '*.sh' -o -name '*.mk' -o -name '*.prop' -o -name '*.xml' -o -type f -name '*config' -o -name 'Makefile' -o -name '*.rc' -o -name 'platform' -o -name 'Drivers'  -o -name '*.scons' -o -name '*.api' -o -name '*.tla' -o -name '*.smh' -o -name '*.smi' -o -name '*.smt' -o -name '*.idl' -o -name '*.te' -o -name '*.py' -o -name '*.S' > cscope.files 
time cscope -bkq -i cscope.files

elif [ $1 == "mtk_kk_old_kernel_tags_update" ]
then
 echo "update mtk kk old android kernel proj cscope tags"
 find  mediatek/ kernel/ -name '*.c' -o -name '*.cpp' -o -name '*.h' -o -name '*.cc' -o -name '*.java'  -o -name '*.sh' -o -name '*.mk' -o -name '*.prop' -o -name '*.xml' -o -type f -name '*config' -o -name 'Makefile' -o -name '*.rc' -o -name 'platform' -o -name 'Drivers'  -o -name '*.te' -o -name '*.py' -o -name '*.S' > cscope.files 
time  cscope -bkq -i cscope.files

elif [ $1 == "kernel_arm32_cscope" ]
then
	echo "gen cscope tags for ARCH=arm kernel: make cscope ARCH=arm"
	time make cscope ARCH=arm
	echo "done........................................."

elif [ $1 == "update_ctags" ]
then
	if [ -f cscope.files ]
	then
		echo "gen ctags, for echofunc.vim and srcexpl.vim, use cscope files"
		echo "command : ctags -R --fields=+lS -L tag.files"
		echo "gen...."
		cp cscope.files tag.files
		if [[ $(sed -n '1p' tag.files) == "-k" ]]
		then
			echo "kernel cscope source file, remove -k -q"
			sed -i '1,2d' tag.files
		fi
		time ctags -R --fields=+lS -L tag.files
		rm tag.files
		echo "done........................................."
	else
		echo "ERR: Can not find cscope.files, gen it firstly"
	fi

elif [ $1 == "kernel_arm64_cscope" ]
then
	echo "gen cscope tags for ARCH=arm64 kernel: make cscope ARCH=arm64"
	time make cscope ARCH=arm64
	echo "done........................................."
else 
 print_usage
 echo "Nothing DONE!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"
fi
