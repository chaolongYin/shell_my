#!/bin/bash
function print_usage(){
#conflict with some command,eg find or sed,some print usage means cat other_shell_usage
cat ~/shell_my/unexeshell/other_shell_usage
echo "Usage:"
echo "other_shell argc:"
echo "		mtk_kk_old_kernel_cscope "
echo "		arm32_cscope arm64_cscope normal_cscope "
echo "		ctags_base_cscope_files ycm_config_gen "
echo "		arm64_cscope_ctags arm32_cscope_ctags normal_cscope_ctags"
}
if [ $# -eq 0 ]
then
	echo "just show usage"
	print_usage

elif [ $1 == "normal_cscope" ]
then
	echo "update normal proj cscope current dir"
find . -name '*.c' -o -name '*.cpp' -o -name '*.h' -o -name '*.cc' -o -name '*.java'  -o -name '*.sh' -o -name '*.mk' -o -name '*.prop' -o -name '*.xml' -o -type f -name '*config' -o -name 'Makefile' -o -name '*.rc' -o -name 'platform' -o -name 'Drivers'  -o -name '*.scons' -o -name '*.api' -o -name '*.tla' -o -name '*.smh' -o -name '*.smi' -o -name '*.smt' -o -name '*.idl' -o -name '*.te' -o -name '*.py' -o -name '*.S' > cscope.files 
time cscope -bkq -i cscope.files

elif [ $1 == "mtk_kk_old_kernel_cscope" ]
then
 echo "update mtk kk old android kernel proj cscope tags"
 find  mediatek/ kernel/ -name '*.c' -o -name '*.cpp' -o -name '*.h' -o -name '*.cc' -o -name '*.java'  -o -name '*.sh' -o -name '*.mk' -o -name '*.prop' -o -name '*.xml' -o -type f -name '*config' -o -name 'Makefile' -o -name '*.rc' -o -name 'platform' -o -name 'Drivers'  -o -name '*.te' -o -name '*.py' -o -name '*.S' > cscope.files 
time  cscope -bkq -i cscope.files

elif [ $1 == "arm32_cscope" ]
then
	echo "gen cscope for ARCH=arm kernel: make cscope ARCH=arm"
	time make cscope ARCH=arm
	echo "done........................................."

elif [ $1 == "ctags_base_cscope_files" ]
then
	if [ -f cscope.files ]
	then
		echo "gen ctags, for echofunc.vim and srcexpl.vim, use cscope files"
		echo "command : ctags -R --fields=+lS -L tag.files"
		echo "gen...."
		cp cscope.files tag.files
		if [[ $(sed -n '1p' tag.files) == "-k" ]]
		then
			echo "kernel cscope source file, remove -k -q"
			sed -i '1,2d' tag.files
		fi
		time ctags -R --fields=+lS -L tag.files
		rm tag.files
		echo "done........................................."
	else
		echo "ERR: Can not find cscope.files, gen it firstly"
	fi

elif [ $1 == "arm64_cscope" ]
then
	echo "gen cscope for ARCH=arm64 kernel: make cscope ARCH=arm64"
	time make cscope ARCH=arm64
	echo "done........................................."
elif [ $1 == ycm_config_gen ]
then
	echo "gen ycm_extra_conf for special proj,eg kernel"
	echo "use command : python ~/.vim/bundle/YCM-Generator/config_gen.py . --compiler=/usr/bin/clang-3.5"
	echo "for --compiler, you may chosse cc or aarch64-linux-gnu-gcc etc"
	if [ -f ~/.vim/bundle/YCM-Generator/config_gen.py ]
	then
		echo "Find config_gen.py ,try to gen ..."
		python ~/.vim/bundle/YCM-Generator/config_gen.py . --compiler=/usr/bin/clang-3.5
	else
		echo "Can not find ~/.vim/bundle/YCM-Generator/config_gen.py, pls check vim config"
	fi
elif [ $1 == "arm64_cscope_ctags" ]
then
	echo "Both gen cscope and ctags for arm64"
	other_shell arm64_cscope
	other_shell ctags_base_cscope_files
elif [ $1 == "arm32_cscope_ctags" ]
then
	echo "Both gen cscope and ctags for arm32"
	other_shell arm32_cscope
	other_shell ctags_base_cscope_files
elif [ $1 == "normal_cscope_ctags" ]
then
	echo "Both gen cscope and ctags for normal proj"
	other_shell normal_cscope
	other_shell ctags_base_cscope_files
else 
 print_usage
 echo "Nothing DONE!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"
fi
